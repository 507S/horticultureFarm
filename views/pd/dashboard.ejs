<%- include('../includes/header')-%>
<div class="wrapper">
    <%- include('../includes/topbar')-%>

    <div class="page-wrap">
        <%- include('../includes/sidebar')-%>
        <div class="main-content">
            <div class="container-fluid">
                <div class="row clearfix">
                    
                    <div class="col ">
                        <div class="widget">
                            <div class="widget-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="state">
                                        <h6>চারা উৎপাদন</h6>
                                        <h4 id="totalProduction"><%= new Number(totalProduction).toLocaleString("bn-BD") %></h4>
                                    </div>
                                    <div class="icon">
                                        <i class="ik ik-award"></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="col ">
                        <div class="widget">
                            <div class="widget-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="state">
                                        <h6>চারা বিতরণ</h6>
                                        <h4 id="totalBitoron"> <%= new Number(totalBitoron).toLocaleString("bn-BD") %> </h4>
                                    </div>
                                    <div class="icon">
                                        <i class="ik ik-award"></i>
                                    </div>
                                </div>

                            </div>

                        </div>
                    </div>
                    <div class="col ">
                        <div class="widget">
                            <div class="widget-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="state">
                                        <h6>চারা সংরক্ষণ/মজুদ</h6>
                                        <h4 id="totalMojud"><%= new Number(totalProduction - totalBitoron).toLocaleString("bn-BD") %></h4>
                                    </div>
                                    <div class="icon">
                                        <i class="ik ik-award"></i>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="col ">
                        <div class="widget">
                            <div class="widget-body">
                                <div class="d-flex justify-content-between align-items-center">
                                    <div class="state">
                                        <h6>রাজস্ব আয়</h6>
                                        <h4 id="totalrajossho"><%= new Number(totalrajossho).toLocaleString("bn-BD") %></h4>
                                    </div>
                                    <div class="icon">
                                        <i class="ik ik-award"></i>
                                    </div>
                                </div>
                            </div>

                        </div>
                    </div>
                    <div class="col">
                        <select id="center" class="form-control">
                            <option value="all">সব  সেন্টার</option>
                            <% center.forEach((row) => { %>
                                <option value="<%= row.id %>"> <%= row.center %> </option>
                            <%  }) %>
                        </select>
                    </div>
                </div>
                <div class="row">
                    <div class="container-fluid">

                        <div class="card">
                            <div class="card-body">
                                <div class="form-row">
                                        <label for="newRajosshoCode" class="col-md-1 control-label"> নতুন সেন্টার যোগ করুন :</label>
                                        
                                        <div class="col-md-3">
                                            <a href="/center/signup" class="btn btn-primary">যোগ করুন</a>  
                                        </div>
                                </div>
                            </form>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <div class="form-row">
                                        <label for="newRajosshoCode" class="col-md-1 control-label"> ছবি আপ্লোড করুন :</label>
                                        
                                        <div class="col-md-3">
                                            <a href="/pd/dashImageForm" class="btn btn-primary">আপ্লোড করুন</a>  
                                        </div>
                                </div>
                            </form>
                            </div>
                        </div>

                        <div class="card">
                            <div class="card-body">
                                <%if (dashImage.length >0){ %>
                                    <div class="container">
                                      <div class="row">
                                        <% dashImage.forEach(function(row){ %>
                                        <div class="col-md-4" >
                                          <div class="card">
                                                <img class="card-img-top" src="<%= row.image %>"  width="auto" height="200px" alt="Card image">
                                                <div class="card-body">
                                                  <h4 class="card-title"><%= row.name %></h4>
                                                  <p class="card-text"><%= row.description %></p>
                                                  <p class="card-text"><%= row.date%></p>
                                                  <a href="/open/<%= row.id %>" class="btn btn-success" style="text-decoration:none;"><i class="fa fa-search-plus"></i> Open   </a>
                                                  <a href="/edit/<%= row.id %>" class="btn btn-primary" style="text-decoration:none;"> <i class="fa fa-edit"></i> Edit  </a>
                                                  <a href="/delete/<%= row.id %>" class="btn btn-danger"  style="text-decoration:none;"> <i class="fa fa-trash"></i> Delete</a>
                                                </div>
                                          </div>
                                        </div>
                                      
                                      <% }) %>
                                    </div>
                                  </div>
                                  <% }else{ %>
                                      <% dashImage.forEach(function(row){ %>
                                          <div class="container">
                                              <h2></h2>
                                              <p></p>
                                              <div class="card" style="width:400px">
                                                <img class="card-img-top" src="<%= row.image %>" alt="Card image" style="width:100%">
                                                <div class="card-body">
                                                  <h4 class="card-title"> </h4>
                                                  <p class="card-text">No data Found</p>
                                                  <a href="#" class="btn btn-primary"></a>
                                                </div>
                                              </div>
                                          </div>
                                      <% }) %>
                                  <% } %>
                            </div>
                        </div>
                        

                        

                       

                        
                       

                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
<%- include('../includes/footer')-%>
<script type="text/javascript">
    $('#center').on("change",function () {
        var center = $('#center').val();
        $.ajax({
            type: "POST",
            url: "/centerData",
            data: {center: center},
            datatype: "json",
            beforeSend: function() {
                // setting a timeout
                $('#loading').show();
                $('#output').hide();
            },
            success: function (data) {
                $('#totalProduction').html(new Number(data.totalProduction).toLocaleString("bn-BD"));
                $('#totalBitoron').html(new Number(data.totalBitoron).toLocaleString("bn-BD"));
                $('#totalMojud').html(new Number(data.totalProduction - data.totalBitoron).toLocaleString("bn-BD"));
                $('#totalrajossho').html(new Number(data.totalrajossho).toLocaleString("bn-BD"));

            },
            complete: function() {
                $('#loading').hide();
                $('#output').show();
            }
        });
    });
</script>